<!-- Encabezado-->
<section class="container-fluid" style="background-color:#FFC300">
  <nav class="navbar">
    <section class="container-fluid mt-0 barra">
      <a class="navbar-brand">
        <img src="vista/images/iconos/logo-a.png" height="80px" >
      </a>
      <section class="d-flex">
        <article class="mt-3 me-2">
          <?php echo $_SESSION['nombre'];?>&nbsp;
        </article>
        <article class="btn-group">
          <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"  style="background-color:#FFC300; border-color: #FFC300;">
            <i class="fas fa-user-circle user"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" style="background-color:#581845;">
            <li><a class="dropdown-item cerrar" href="admin" style="color:white;"><i class="bi bi-arrow-left-circle-fill m-1"></i>Regresar</a></li>
            <li><a class="dropdown-item cerrar" href="Javascript:salir()" style="color:white;"><i class="fas fa-sign-out-alt m-1" ></i>Salir</a></li>
          </ul>
        </article>                
      </section>
    </section>
  </nav>
</section>
<section class="contenedor">
  <!-- Titulo de la seccion de la parte superior-->
  <section class="container-fluid" style="background-color: #0C2233; color: aliceblue;">
    <section class="row">
      <article class="col-md-8 d-flex justify-content-center">
        <h6 class="fw-bold fs-5 fs-md-4 fs-lg-3"><i class="bi bi-arrow-repeat"></i>Actualizar datos del platillo</h6>
      </article>
      <article class="col-md-2 d-flex justify-content-center flex-grow-1 p-1 hoverIR-h6" style="cursor:pointer;">
        <h6 class="fw-bold fs-6 fs-md-5 fs-lg-4 "><a href="admin" style="color:white; text-decoration: none;"><i class="bi bi-arrow-left-circle-fill m-1"></i>Regresar</a></h6>
      </article>
    </section>
  </section>

  <section class="container-fluid">
    <section class="mt-3 font-weight-bold p-3">
      <!-- Pestañas de navegacion -->
      <nav style="background-color:#fbfdfe; border-radius: 5px;">
        <section class="nav nav-tabs" id="nav-tab" role="tablist">
          <button class="nav-link active" id="nav-datos-tab" data-bs-toggle="tab" data-bs-target="#nav-datos" type="button" role="tab" aria-controls="nav-datos" aria-selected="true">Datos del platillo</button>
          <button class="nav-link" id="nav-ingredientes-tab" data-bs-toggle="tab" data-bs-target="#nav-ingredientes" type="button" role="tab" aria-controls="nav-ingredientes" aria-selected="false">Ingredientes</button>
          <button class="nav-link" id="nav-utencilios-tab" data-bs-toggle="tab" data-bs-target="#nav-utencilios" type="button" role="tab" aria-controls="nav-utencilios" aria-selected="false">Utencilios</button>
          <button class="nav-link" id="nav-preparacion-tab" data-bs-toggle="tab" data-bs-target="#nav-preparacion" type="button" role="tab" aria-controls="nav-preparacion" aria-selected="false">Preparación</button>
          <button class="nav-link" id="nav-nutriente-tab" data-bs-toggle="tab" data-bs-target="#nav-nutriente" type="button" role="tab" aria-controls="nav-nutriente" aria-selected="false">Información nutrimental</button>
          <button class="nav-link" id="nav-complemento-tab" data-bs-toggle="tab" data-bs-target="#nav-complemento" type="button" role="tab" aria-controls="nav-complemento" aria-selected="false">Información adicional</button>
        </section>
      </nav>
      <!-- Contenido de la seccion -->
      <main class="tab-content" id="nav-tabContent">
        <section class="tab-pane fade show active" id="nav-datos" role="tabpanel" aria-labelledby="nav-datos-tab" tabindex="0">
          <!-- Sección 1: Datos del platillo -->
          <section id="section1" class="mt-1">
            <header class="p-1" style="background-color: #00b1ce; color:white; border-radius:5px;">
              <h4>Sección 1: Datos del platillo</h4>
            </header>
            <form id="formDatosP" class="row g-3 needs-validation"  method="POST"  enctype="multipart/form-data">
              <input type="hidden" name="idPlatillo" id="idPlatillo" value="<?php echo $platillo->getId(); ?>" required>
              <article class="col-md-6">
                <label for="nombrePlatillo" class="form-label">Nombre</label>
                <input type="text" class="form-control" name="nombrePlatillo" id="nombrePlatillo" required value="<?php echo $platillo->getNombre(); ?>">

              </article>
              <article class="col-md-6">
                <label for="tiempoComida" class="form-label">Tiempo de Comida</label>
                <select class="form-select text-center" name="tiempoComida" id="tiempoComida" required>
                  <?php
                  $opcionesTiempoComida = array(
                    1 => 'Desayuno', 2 => 'Colación de la mañana', 3 => 'Comida', 4 => 'Postre', 5 => 'Colación de la tarde',
                    6 => 'Cena', 7 => 'Otros'
                  );

                  foreach ($opcionesTiempoComida as $valor => $texto) {
                    $selected = ($platillo->getTiempoComida() == $valor) ? 'selected' : '';
                    echo '<option value="' . $valor . '" ' . $selected . '>' . $texto . '</option>';
                  }
                  ?>
                </select>
              </article>
              <article class="col-md-6">
                <label for="tiempoPreparacion" class="form-label">Tiempo de preparación</label>
                <input type="text" name="tiempoPreparacion" id="tiempoPreparacion"  class="form-control" required value="<?php echo $platillo->getTiempoPreparacion(); ?>">
              </article>
              <article class="col-md-6">
                <label for="tiempoCoccion" class="form-label">Tiempo de coccion</label>
                <input type="text" class="form-control" name="tiempoCoccion" id="tiempoCoccion" required value="<?php echo $platillo->getTiempoCoccion(); ?>">
              </article>
              <article class="col-md-6">
                <label for="caducidad" class="form-label">Caducidad</label>
                <input type="text" class="form-control" name="caducidad" id="caducidad" required value="<?php echo $platillo->getCaducidad(); ?>">
              </article>
              <article class="col-md-6">
                <label for="porciones" class="form-label">Porciones</label>
                <input type="text" class="form-control" name="porciones" id="porciones" required value="<?php echo $platillo->getPorciones(); ?>">
              </article>
              <article class="col-md-6">
                <label for="costoPromedio" class="form-label">Costo Promedio</label>
                <input type="text" class="form-control" name="costoPromedio" id="costoPromedio" required value="<?php echo $platillo->getCostoPromedio(); ?>">
              </article>
              <article class="col-md-6">
                <label for="rendimiento" class="form-label">Rendimiento</label>
                <input type="text" class="form-control" name="rendimiento" id="rendimiento" required value="<?php echo $platillo->getRendimiento(); ?>">
              </article>
              <article class="col-md-6">
                <label for="descripcion" class="form-label">Descripcion del Platillo</label>
                <textarea name="descripcion" id="descripcion" class="form-control" required><?php echo $platillo->getDescripcion(); ?></textarea>
              </article>
              <article class="col-md-6">
                <img src="data:image/png;base64,<?php echo base64_encode($platillo->getImagen()); ?>" width="50px" height="50px">
                <label for="imagenPlatillo" class="form-label">Subir imagen del Platillo <strong>(Si deseas Actualizarla)</strong></label>
                <br>
                <input type="file" class="form-control mt-1" name="imagenPlatillo" id="imagenPlatillo"  accept="image/*">
              </article>
            </form>
            <br>
            <article class="p-2" style="background-image: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%); border-radius:5px;">
              <center>
               <button class="btn btn-info text-white" onclick="validarFormulario('formDatosP', 'nav-datos')">Actualizar</button>
             </center>
           </article>                 
          </section>
        </section>
        <section class="tab-pane fade" id="nav-ingredientes" role="tabpanel" aria-labelledby="nav-ingredientes-tab" tabindex="0">
          <!-- Sección 2: Ingredientes -->
          <section id="section2" class="mt-1">
            <header class="p-1" style="background-color: #00b1ce; color:white; border-radius:5px;">
              <h4>Sección 2: Ingredientes</h4>
            </header>
            <!-- Campos del formulario de Ingredientes -->
           <form id="formIngredientes" class="container mt-3">
            <hr>
            <input type="hidden" name="idPlatillo" id="idPlatillo" value="<?php echo $platillo->getId(); ?>" required>
            <section id="grupoFormularioContainer">
              <?php foreach ($listaIngredientes as $ingrediente): ?>
                <section class="grupo-formulario row" data-form-id="formIngredientes">
                  <input type="hidden" name="idIngrediente" class="idIngrediente" value="<?php echo $ingrediente->getId(); ?>" required>
                  <article class="col-md-3 p-1">
                    <input type="text" name="nombreIngrediente" class="form-control" required value="<?php echo $ingrediente->getNombre(); ?>">
                  </article>
                  <article class="col-md-3 p-1">
                    <input type="text" name="cantidad" class="form-control" required value="<?php echo $ingrediente->getCantidad(); ?>">
                  </article>
                  <article class="col-md-3 p-1">
                    <input type="text" name="unidadMedida" class="form-control" required value="<?php echo $ingrediente->getUnidadMedida(); ?>">
                  </article>
                  <article class="col-md-3 p-1">
                    <button class="btn btn-danger remove-btn" type="button" data-ingrediente-id="<?php echo $ingrediente->getId(); ?>">Eliminar</button>
                  </article>
                </section>
              <?php endforeach; ?>
            </section>
            <section class="p-1">
              <button class="btn btn-primary" id="btnAgregar" type="button">Agregar más</button>
            </section>
          </form>

            <br>
            <article class="p-2" style="background-image: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%); border-radius:5px;">
              <center>
               <button class="btn btn-info text-white"  onclick="validarFormulario('formIngredientes', 'nav-ingredientes')">Actualizar</button>
             </center>
           </article>
          </section>
        </section>
        <section class="tab-pane fade" id="nav-utencilios" role="tabpanel" aria-labelledby="nav-utencilios-tab" tabindex="0">
          <!-- Sección 3: Utencilios -->
          <section id="section3" class="mt-1">
            <header class="p-1" style="background-color: #00b1ce; color:white; border-radius:5px;">
              <h4>Sección 3: Utencilios</h4>
            </header>
            <!-- Campos del formulario de Utencilios -->
            <form id="formUtencilio" class="container mt-3">
              <hr>
              <input type="hidden" name="idPlatillo" id="idPlatillo" value="<?php echo $platillo->getId(); ?>" required>
              <section id="formularioUtenciliosContainer">
                <?php foreach ($listaUtencilio as $utencilio): ?>
                  <section class="formulario-utencilios row" data-form-id="formUtencilio">
                    <input type="hidden" name="idUtencilio" class="idUtencilio" value="<?php echo $utencilio->getId(); ?>" required>
                    <article class="col-md-4 p-1">
                      <input type="text" name="nombreUtencilio" class="form-control" required value="<?php echo $utencilio->getNombre(); ?>">
                    </article>
                    <article class="col-md-4 p-1">
                      <input type="number" name="cantidad" min="1" class="form-control" required value="<?php echo $utencilio->getCantidad(); ?>">
                    </article>
                    <article class="col-md-4 p-1">
                      <button class="btn btn-danger remove-btn-utencilios" type="button" data-utencilio-id="<?php echo $utencilio->getId(); ?>">Eliminar</button>
                    </article>
                  </section>
                <?php endforeach; ?>
              </section>
              <section class="p-1">
                <button class="btn btn-primary" id="btnAgregarUtencilios" type="button">Agregar más</button>
              </section>
            </form>
            <br>
            <article class="p-2" style="background-image: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%); border-radius:5px;">
              <center>
               <button class="btn btn-info text-white" onclick="validarFormulario('formUtencilio', 'nav-utencilios')">Actualizar</button>
             </center>
           </article>
          </section>
        </section>
        <section class="tab-pane fade" id="nav-preparacion" role="tabpanel" aria-labelledby="nav-preparacion-tab" tabindex="0">
          <!-- Sección 4: Preparacion -->
          <section id="section4" class="mt-1">
            <header class="p-1" style="background-color: #00b1ce; color:white; border-radius:5px;">
              <h4>Sección 4: Preparación</h4>
            </header>
            <!-- Campos del formulario de Preparación -->
            <form id="formPreparacion" class="container mt-3" enctype="multipart/form-data">
              <hr>
              <input type="hidden" name="idPlatillo" id="idPlatillo" value="<?php echo $platillo->getId(); ?>" required>
              <section id="formularioPreparacionContainer">
                <?php foreach ($listaPreparacion as $preparacion): ?>
                  <section class="formulario-preparacion row">
                    <input type="hidden" name="idPreparacion" class="idPreparacion" value="<?php echo $preparacion->getId(); ?>" required>
                    <article class="col-md-3 p-1">
                      <label for="paso">Número de paso</label>
                      <input type="number" name="paso" class="form-control" min="1" required value="<?php echo $preparacion->getPaso(); ?>">
                    </article>
                    <article class="col-md-3 p-1">
                      <label for="instruccion">Instrucción</label>
                      <textarea class="form-control" name="instruccion" required><?php echo $preparacion->getInstruccion(); ?></textarea>
                    </article>
                    <article class="col-md-3 p-1">
                      <?php if ($preparacion->getFoto() != null && strlen($preparacion->getFoto()) > 1): ?>
                        <img src="data:image/png;base64,<?php echo base64_encode($preparacion->getFoto()); ?>" width="50px" height="50px">
                      <?php endif; ?>

                      <label for="imagen">Subir foto, si deseas actualizarla </label>
                      <input type="file" name="fotoPreparacion" id="fotoPreparacion" class="form-control mt-1" accept="image/*">
                    </article>
                    <article class="col-md-3 p-4">
                      <button class="btn btn-danger remove-btn-preparacion" type="button">Eliminar</button>
                    </article>
                  </section>
                <?php endforeach; ?>
              </section>
              <section class="p-1">
                <button class="btn btn-primary" id="btnAgregarPreparacion" type="button">Agregar más</button>
              </section>
            </form>
            <br>
            <article class="p-2" style="background-image: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%); border-radius:5px;">
              <center>
               <button class="btn btn-info text-white" onclick="validarFormulario('formPreparacion', 'nav-preparacion')">Actualizar</button>
             </center>
            </article>
          </section>
        </section>
        <section class="tab-pane fade" id="nav-nutriente" role="tabpanel" aria-labelledby="nav-nutriente-tab" tabindex="0">
          <!-- Sección 5: Información Nutrimental -->
          <section id="section5" class="mt-1">
            <header class="p-1" style="background-color: #00b1ce; color:white; border-radius:5px;">
              <h4>Sección 5: Información Nutrimental</h4>
            </header>
            <!-- Campos del Información Nutrimental -->
            <form id="formNutriente" class="container mt-3">
              <hr>
              <input type="hidden" name="idPlatillo" id="idPlatillo" value="<?php echo $platillo->getId(); ?>" required>
              <section id="formularioNutrimentalContainer">
                <?php foreach ($listaNutriente as $nutriente): ?>
                  <section class="formulario-nutrimental row" data-form-id="formNutriente">
                    <input type="hidden" name="idNutriente" class="idNutriente" value="<?php echo $nutriente->getId(); ?>" required>
                    <article class="col-md-2 p-1">
                      <input type="text" class="form-control" name="nombreNutriente" required value="<?php echo $nutriente->getNombre(); ?>">
                    </article>
                    <article class="col-md-3 p-1">
                      <input type="number" class="form-control" name="cantidadR" required value="<?php echo $nutriente->getCantidadR(); ?>">
                    </article>
                    <article class="col-md-3 p-1">
                      <input type="number" class="form-control" name="cantidadP" required value="<?php echo $nutriente->getCantidadP(); ?>">
                    </article>
                    <article class="col-md-2 p-1">
                      <input type="text" class="form-control" name="unidadMedida" required value="<?php echo $nutriente->getUnidadMedida(); ?>">
                    </article>
                    <article class="col-md-2 p-1">
                      <button class="btn btn-danger remove-btn-nutrimental" type="button" data-utencilio-id="<?php echo $nutriente->getId(); ?>">Eliminar</button>
                    </article>
                  </section>
                <?php endforeach; ?>
              </section>
              <section class="p-1">
                <button class="btn btn-primary" id="btnAgregarNutrimental" type="button">Agregar más</button>
              </section>
            </form>
            <br>
            <article class="p-2" style="background-image: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%); border-radius:5px;">
              <center>
               <button class="btn btn-info text-white" onclick="validarFormulario('formNutriente', 'nav-nutriente')">Actualizar</button>
             </center>
           </article>
          </section>  
        </section>
        <section class="tab-pane fade" id="nav-complemento" role="tabpanel" aria-labelledby="nav-complemento-tab" tabindex="0">
          <!-- Sección 6: Informacion adicional -->
          <section id="section6" class="mt-1">
            <header class="p-1" style="background-color: #00b1ce; color:white; border-radius:5px;">
              <h4>Sección 6: Información Adicional</h4>
            </header>
            <form id="formComplemento" class="container row">
              <input type="hidden" name="idPlatillo" id="idPlatillo" value="<?php echo $platillo->getId(); ?>" required>
              <input type="hidden" name="idComplemento" id="idComplemento" value="<?php echo $complemento->getId(); ?>" required>
              <article class="col-md-6">
                <label for="codigo" class="form-label text-dark"><i class="bi bi-geo-fill" style="color: #F77C44;"></i>&nbsp;Estado a la que pertenece el platillo</label>
               <select class="form-select" id="estado" name="estado" required>
                  <option value="" <?php echo ($complemento->getEstado() === '') ? 'selected="selected"' : ''; ?>>-- Seleccione --</option>
                  <?php
                  $estados = array(
                    "Aguascalientes", "Baja California", "Baja California Sur", "Campeche", "Coahuila de Zaragoza",
                    "Colima", "Chiapas", "Chihuahua", "Ciudad de México", "Durango", "Guanajuato", "Guerrero",
                    "Hidalgo", "Jalisco", "México", "Michoacán de Ocampo", "Morelos", "Nayarit", "Nuevo León",
                    "Oaxaca", "Puebla", "Querétaro", "Quintana Roo", "San Luis Potosí", "Sinaloa", "Sonora",
                    "Tabasco", "Tamaulipas", "Tlaxcala", "Veracruz", "Yucatán", "Zacatecas"
                  );
                  foreach ($estados as $estado) {
                    echo '<option value="' . $estado . '" ' . (($complemento->getEstado() === $estado) ? 'selected="selected"' : '') . '>' . $estado . '</option>';
                  }
                  ?>
                </select>
              </article>
              <article class="col-md-6">
                <label for="region" class="form-label">Región del platillo</label>
                <input type="text" name="region" id="region" class="form-control" required value="<?php echo $complemento->getRegion(); ?>">
              </article>
              <article class="col-md-6">
                <label for="municipio" class="form-label">Municipio del platillo</label>
                <input type="text" name="municipio" id="municipio" class="form-control" required value="<?php echo $complemento->getMunicipio(); ?>">
              </article>
              <article class="col-md-6">
                <label for="lengua" class="form-label">Lengua que hablan</label>
                <input type="text" name="lengua" id="lengua" class="form-control" required value="<?php echo $complemento->getLengua(); ?>">
              </article>
              <article class="col-md-6">
                <label for="cultura" class="form-label">Cultura que pertenecen</label>
                <input type="text" name="cultura" id="cultura" class="form-control" required value="<?php echo $complemento->getCultura(); ?>">
              </article>
            </form>
            <br>
            <article class="p-2" style="background-image: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%); border-radius:5px;">
              <center>
               <button class="btn btn-info text-white" onclick="validarFormulario('formComplemento', 'nav-complemento')">Actualizar</button>
             </center>
            </article>
          </section>
        </section>
      </main>          
    </section>
  </section>
</section>


<script>
  /*Funcion para agregar o eliminar formulario de Ingredientes */
  $(document).ready(function() {
    // Agregar nuevo grupo de formulario al hacer clic en el botón "Agregar más"
    $('#btnAgregar').click(function() {
      let grupoFormulario = '<section class="grupo-formulario row" data-form-id="formIngredientes">' +
        '<article class="col-md-3 p-1">' +
        '<input type="text" name="nombreIngrediente" class="form-control" required placeholder="Nombre">' +
        '</article>' +
        '<article class="col-md-3 p-1">' +
        '<input type="text" name="cantidad" class="form-control" required placeholder="Cantidad">' +
        '</article>' +
        '<article class="col-md-3 p-1">' +
        '<input type="text" name="unidadMedida" class="form-control" required placeholder="Unidad de Medida">' +
        '</article>' +
        '<article class="col-md-3 p-1">' +
        '<button class="btn btn-danger remove-btn" type="button">Eliminar</button>' +
        '</article>' +
        '</section>';
      $('#grupoFormularioContainer').append(grupoFormulario);
    });

    // Eliminar grupo de formulario
    $(document).on('click', '.remove-btn', function() {
      const formSection = $(this).closest('.grupo-formulario');
      const ingredienteId = formSection.find('.idIngrediente').val();

      if (!ingredienteId) {
        // Si el campo idIngrediente no tiene valor, simplemente eliminar el formulario en el cliente
        formSection.remove();
        return;
      }

      console.log(ingredienteId);
      // Preguntar al usuario si está seguro de eliminar el grupo de ingredientes
      Swal.fire({
        title: '¿Estás seguro?',
        text: 'Esta acción eliminará el grupo de ingredientes.',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Sí, eliminar',
        cancelButtonText: 'Cancelar'
      }).then((result) => {
        if (result.isConfirmed) {
          // Si el usuario confirma la eliminación, realizar la solicitud al servidor
          const formId = formSection.data('form-id');
          $.ajax({
            url: 'ajax/eliminarIngrediente.php',
            method: 'POST',
            data: { idIngrediente: ingredienteId },
            success: function(response) {
              // Si la eliminación en el servidor fue exitosa, eliminar también el formulario en el cliente
              formSection.remove();

              // Mostrar mensaje de éxito después de eliminar el grupo de ingredientes
              Swal.fire({
                icon: 'success',
                title: '¡Eliminado!',
                text: 'El grupo de ingredientes se eliminó correctamente.',
                showConfirmButton: false,
                timer: 1500
              });
            },
            error: function(error) {
              console.error('Error al eliminar el ingrediente: ', error);
            }
          });
        }
      });
    });
  });

  /*Funcion para agregar o eliminar formulario de Utencilios */
  $(document).ready(function() {
    // Agregar nuevo grupo de formulario al hacer clic en el botón "Agregar más"
    $('#btnAgregarUtencilios').click(function() {
      let formularioUtencilios = '<section class="formulario-utencilios row" data-form-id="formUtencilio">' +
      '<article class="col-md-4 p-1">' +
      '<input type="text" name="nombreUtencilio" id="nombreUtencilio" class="form-control" placeholder="Nombre del utencilio" required>' +
      '</article>' +
      '<article class="col-md-4 p-1">' +
      '<input type="number" name="cantidad" id="cantidad" min="1" class="form-control" placeholder="Cantidad de utencilios" required>' +
      '</article>' +
      '<article class="col-md-4 p-1">' +
      '<button class="btn btn-danger remove-btn-Utencilios" type="button">Eliminar</button>' +
      '</article>' +
      '</section>';
      $('#formularioUtenciliosContainer').append(formularioUtencilios);
    });
    
    // Eliminar grupo de formulario
    $(document).on('click', '.remove-btn-utencilios', function() {
      const formSection = $(this).closest('.formulario-utencilios');
      const utencilioId = formSection.find('.idUtencilio').val();

      if (!utencilioId) {
        // Si el campo idIngrediente no tiene valor, simplemente eliminar el formulario en el cliente
        formSection.remove();
        return;
      }

      console.log(utencilioId);
      // Preguntar al usuario si está seguro de eliminar el grupo de utencilios
      Swal.fire({
        title: '¿Estás seguro?',
        text: 'Esta acción eliminará el grupo de utencilios',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Sí, eliminar',
        cancelButtonText: 'Cancelar'
      }).then((result) => {
        if (result.isConfirmed) {
          // Si el usuario confirma la eliminación, realizar la solicitud al servidor
          const formId = formSection.data('form-id');
          $.ajax({
            url: 'ajax/eliminarUtencilio.php',
            method: 'POST',
            data: { idUtencilio: utencilioId },
            success: function(response) {
              // Si la eliminación en el servidor fue exitosa, eliminar también el formulario en el cliente
              formSection.remove();

              // Mostrar mensaje de éxito después de eliminar el grupo de utencilios
              Swal.fire({
                icon: 'success',
                title: '¡Eliminado!',
                text: 'El grupo de utencilios se eliminó correctamente.',
                showConfirmButton: false,
                timer: 1500
              });
            },
            error: function(error) {
              console.error('Error al eliminar el utencilio: ', error);
            }
          });
        }
      });
    });
  });

  /*Funcion para agregar o eliminar formulario de Preparacion */
  $(document).ready(function() {
    // Agregar nuevo grupo de formulario al hacer clic en el botón "Agregar más"
    $('#btnAgregarPreparacion').click(function() {
      let formularioPreparacion = '<section class="formulario-preparacion row">' +
      '<article class="col-md-3 p-1">' +
      '<label for="paso">Número de paso</label>'+
      '<input type="number" name="paso" id="paso" min="1" class="form-control" required>' +
      '</article>' +
      '<article class="col-md-3 p-1">' +
      '<label for="instruccion">Instrucción</label>'+
      '<textarea class="form-control" name="instruccion" id="instruccion" required></textarea>' +
      '</article>' +
      '<article class="col-md-3 p-1">' +
      '<label for="imagen">Foto del paso</label>'+
      '<input type="file" name="fotoPreparacion" id="fotoPreparacion" class="form-control" accept="image/*">' +
      '</article>' +
      '<article class="col-md-3 p-4">' +
      '<button class="btn btn-danger remove-btn-preparacion" type="button">Eliminar</button>' +
      '</article>' +
      '</section>';
      $('#formularioPreparacionContainer').append(formularioPreparacion);
    });
    // Eliminar grupo de formulario al hacer clic en el botón "Eliminar"
    $(document).on('click', '.remove-btn-preparacion', function() {
      $(this).closest('.formulario-preparacion').remove();
    });
  });


  /*Funcion para agregar o eliminar formulario de informacion nutrimental */
  $(document).ready(function() {
    // Agregar nuevo grupo de formulario al hacer clic en el botón "Agregar más"
    $('#btnAgregarNutrimental').click(function() {
      let formularioNutrimental = '<section class="formulario-nutrimental row">' +
      '<article class="col-md-2 p-1">' +
      '<input type="text" class="form-control" name="nombreNutriente" id="nombreNutriente" placeholder="Nombre" required>' +
      '</article>' +
      '<article class="col-md-3 p-1">' +
      '<input type="number" class="form-control" name="cantidadR" id="cantidadR" placeholder="Cantidad por receta" required>' +
      '</article>' +
      '<article class="col-md-3 p-1">' +
      '<input type="number" class="form-control" name="cantidadP" id="cantidadP" placeholder="Cantidad por porción" required>' +
      '</article>' +
      '<article class="col-md-2 p-1">'+
      '<input type="text" class="form-control" name="unidadMedida" id="unidadMedida" placeholder="Unidad de Medida" required>'+
      '</article>'+
      '<article class="col-md-2 p-1">' +
      '<button class="btn btn-danger remove-btn-nutrimental" type="button">Eliminar</button>' +
      '</article>' +
      '</section>';
      $('#formularioNutrimentalContainer').append(formularioNutrimental);
    });
  
    // Eliminar grupo de formulario
    $(document).on('click', '.remove-btn-nutrimental', function() {
      const formSection = $(this).closest('.formulario-nutrimental');
      const nutrienteId = formSection.find('.idNutriente').val();

      if (!nutrienteId) {
        // Si el campo idNutriente no tiene valor, simplemente eliminar el formulario en el cliente
        formSection.remove();
        return;
      }

      console.log(nutrienteId);
      // Preguntar al usuario si está seguro de eliminar el grupo de Nutriente
      Swal.fire({
        title: '¿Estás seguro?',
        text: 'Esta acción eliminará el grupo de Nutriente',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Sí, eliminar',
        cancelButtonText: 'Cancelar'
      }).then((result) => {
        if (result.isConfirmed) {
          // Si el usuario confirma la eliminación, realizar la solicitud al servidor
          const formId = formSection.data('form-id');
          $.ajax({
            url: 'ajax/eliminarNutriente.php',
            method: 'POST',
            data: { idNutriente: nutrienteId },
            success: function(response) {
              // Si la eliminación en el servidor fue exitosa, eliminar también el formulario en el cliente
              formSection.remove();

              // Mostrar mensaje de éxito después de eliminar el grupo de Nutriente
              Swal.fire({
                icon: 'success',
                title: '¡Eliminado!',
                text: 'El grupo de Nutriente se eliminó correctamente.',
                showConfirmButton: false,
                timer: 1500
              });
            },
            error: function(error) {
              console.error('Error al eliminar el Nutriente: ', error);
            }
          });
        }
      });
    });
  });
</script>